---
title: "Plate reader plotting : S013"
author: "Prashant"
date: "June 2, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
source('./general_functions_plate_reading.R')
```

## Input data


Copy the tables of GFP, OD, Sample names etc. in excel and run the command below to get it into R

```{r input data, echo = F, message = F}
# User inputs: 1. Enter name of the excel file, 2. Name of the data sheet(S) 3. number of rows and columns in plate reader data 4. Title for plots #comment (file name starts in the previous directory of this Rproject)

gas_data <- read_tsv(clipboard()) # load the whole table with gas, RFP and OD
```

## Data crunching

Doing calculations with the tables, relating sample names with the values

```{r data analysis, echo=FALSE}

merged2 <- gas_data %>% mutate('gas/RFP' = `MeBr peak area`/RFP) # calculate ratio gas/rfp


# merged2 %<>% mutate(Samples = as_factor(Samples), Inducer = as_factor(Inducer)) # freeze order of samples as in the plate - columnwise - for easy plotting
merged2$Inducer %<>% str_c(.,' uM') %>% as_factor()

merged3 <- merged2 %>% group_by(Samples, Inducer) %>%  summarize_at('gas/RFP', funs(mean, sd)) # calculate mean and SD of the GFP/RFP for each Sample and inducer value
# merged3 <- merged2 %>% gather(Reading, Value, OD, GFP, RFP) # gather all the reading into 1 column - to plot multiple
merged4 <- merged3 %>% arrange(mean) %>% ungroup() %>% mutate(Samples = fct_inorder(Samples)) # freeze samples in ascending order of uninduced  
```

## Data tables

Showing raw data and processed data here 

GFP/RFP values
``` {r}
merged2 # format with colours etc for good visualization
```


## Plotting

Plotting

```{r plotting, echo=T}
merged4 %>% ggplot(aes(Samples, mean, color = Inducer)) + geom_point(size = 3) + geom_errorbar(aes(ymin = mean - sd, ymax = mean + sd), width = 0.25) -> plt
plt %<>% format_classic(.) %>% format_logscale()
plt <- plt + ggtitle('S014 : RBS library 7.2 MHT') + ylab('MeBr peak area/RFP (au)')
# ggsave('plots and data/S010_faceted.png', height = 3.5, width = 14)
```
